import base64 , time
encoded = '''CmltcG9ydCB0aW1lCm5hbWUgPSBbJ3Row6BuaCcsICd0csOibicsICduYW0nLCAndGnhur9uJ10KZGVmIHByaW50X3Nsb3codGV4dCwgZGVsYXk9MC4wMyk6CiAgICBmb3IgY2hhciBpbiB0ZXh0OiBwcmludChjaGFyLCBlbmQ9JycsIGZsdXNoPVRydWUpOyB0aW1lLnNsZWVwKDAuMDMpCiAgICBwcmludCgpCm1lbnUgPSBbIuKVlOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVlyIsIuKVkSAgICAg8J+TiyBNRU5VIFFV4bqiTiBMw50gREFOSCBTw4FDSCAgICAgICAg4pWRIiwi4pWg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWjIiwi4pWRICAxLuKelSAgVGjDqm0gdMOqbiAgICAgICAgICAgICAgICAgICAgICDilZEiLCLilZEgIDIu8J+Xke+4jyBYw7NhIHTDqm4gICAgICAgICAgICAgICAgICAgICAgIOKVkSIsIuKVkSAgMy7wn5OMICBDaMOobiB0w6puIHbDoG8gduG7iyB0csOtIGPhu6UgdGjhu4MgICAg4pWRIiwi4pWRICA0LvCfp7kgROG7jW4gc+G6oWNoIGRhbmggc8OhY2ggICAgICAgICAgICDilZEiLCLilZEgIDUu8J+RgCAgSGnhu4NuIHRo4buLIGRhbmggc8OhY2ggICAgICAgICAgICDilZEiLCLilZEgIDAu4p2MICBUaG/DoXQgY2jGsMahbmcgdHLDrG5oICAgICAgICAgICAg4pWRIiwi4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIl0KZm9yIGxpbmUgaW4gbWVudTogcHJpbnRfc2xvdyhsaW5lKQp3aGlsZSBUcnVlOgogICAgY2hvaWNlID0gaW5wdXQoIk5o4bqtcCB2w6BvIGzhu7FhIGNo4buNbiBj4bunYSBi4bqhbiA6IikKICAgIGlmIGNob2ljZSA9PSAnMSc6IG5hbWUuYXBwZW5kKGlucHV0KCJOaOG6rXAgdMOqbiBi4bqhbiBtdeG7kW4gdGjDqm0gdsOgbyBkYW5oIHPDoWNoIDogIikpOyBwcmludF9zbG93KGYi4pyFIERhbmggc8OhY2ggc2F1IGtoaSB0aMOqbSBsw6AgOiB7bmFtZX0iKQogICAgZWxpZiBjaG9pY2UgPT0gJzInOgogICAgICAgIHRvX3JlbW92ZSA9IFtpbnB1dChmIk5o4bqtcCB0w6puIHRo4bupIHtpKzF9IDogIikgZm9yIGkgaW4gcmFuZ2UoaW50KGlucHV0KCJOaOG6rXAgc+G7kSBsxrDhu6NuZyB0w6puIGLhuqFuIG114buRbiB4w7NhIDogIikpKV0KICAgICAgICBmb3IgbiBpbiB0b19yZW1vdmU6IG5hbWUucmVtb3ZlKG4pIGlmIG4gaW4gbmFtZSBlbHNlIHByaW50X3Nsb3coZiLinYwgS2jDtG5nIHTDrG0gdGjhuqV5ICd7bn0nIHRyb25nIGRhbmggc8OhY2guIikKICAgICAgICBwcmludF9zbG93KGYi8J+TiyBEYW5oIHPDoWNoIHNhdSBraGkgeMOzYToge25hbWV9IikKICAgIGVsaWYgY2hvaWNlID09ICczJzoKICAgICAgICB0cnk6IG5hbWUuaW5zZXJ0KGludChpbnB1dCgiTmjhuq1wIHbhu4sgdHLDrSBi4bqhbiBtdeG7kW4gY2jDqG46ICIpKSwgaW5wdXQoIk5o4bqtcCB2w6BvIHTDqm4gYuG6oW4gbXXhu5FuIGNow6huIDogIikpOyBwcmludF9zbG93KGYi4pyFTGlzdCBzYXUga2hpIGNow6huIGzDoCA6IHtuYW1lfSIpCiAgICAgICAgZXhjZXB0OiBwcmludF9zbG93KCLimqDvuI8gVnVpIGzDsm5nIG5o4bqtcCBt4buZdCBz4buRIGjhu6NwIGzhu4cuIikKICAgIGVsaWYgY2hvaWNlID09ICc0JzogbmFtZS5jbGVhcigpOyBwcmludF9zbG93KGYi4pyFTGlzdCBzYXUga2hpIGThu41uIGThurlwIDoge25hbWV9IikKICAgIGVsaWYgY2hvaWNlID09ICc1JzogcHJpbnRfc2xvdyhmIuKchUxpc3QgYmFuIMSR4bqndSBj4bunYSBi4bqhbiBsw6AgOiB7bmFtZX0iKQogICAgZWxpZiBjaG9pY2UgPT0gJzAnOiBwcmludF9zbG93KCJU4bqhbSBiaeG7h3Twn5il8J+YpSIpOyBicmVhawogICAgZWxzZTogcHJpbnRfc2xvdygiVnVpIGzDsm5nIG5o4bqtcCBs4bqhaSDwn5SZIikK''' 
exec(base64.b64decode(encoded).decode('utf-8'))
